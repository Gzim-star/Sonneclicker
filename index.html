<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Find the Ball – Level 2</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: black;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

/* SPIELFELD */
#field {
  position: fixed;
  inset: 0;
}

/* BALL BASIS */
.ball {
  position: absolute;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  opacity: 0;
  transition: opacity 0.25s ease;
  cursor: pointer;
}

/* ECHTER BALL */
.real {
  background: white;
}

/* FAKE BÄLLE */
.fake {
  opacity: 0.18;
}

/* SCHREIBEN */
#drawCanvas {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  border-radius: 6px;
  touch-action: none;
  width: 280px;
  height: 120px;
  z-index: 50;
}

#doneBtn {
  position: fixed;
  bottom: 150px;
  left: 50%;
  transform: translateX(-50%);
  padding: 8px 20px;
  font-size: 14px;
  border: none;
  cursor: pointer;
  z-index: 50;
}

#wordFlash {
  position: fixed;
  top: 20px;
  width: 100%;
  text-align: center;
  font-size: 26px;
  color: white;
  letter-spacing: 6px;
  z-index: 50;
}
</style>
</head>

<body>

<div id="field"></div>
<div id="wordFlash"></div>
<canvas id="drawCanvas" width="280" height="120"></canvas>
<button id="doneBtn">Fertig</button>

<script>
const field = document.getElementById("field");
const canvas = document.getElementById("drawCanvas");
const ctx = canvas.getContext("2d");
const doneBtn = document.getElementById("doneBtn");
const wordFlash = document.getElementById("wordFlash");

/* WÖRTER */
const words = ["FLOW","TRACE","MIND","FOCUS","VOID"];
const fakeColors = ["#6baed6","#9ecae1","#c6dbef","#74c476","#a1d99b","#fd8d3c","#fdae6b"];

let currentWord = "";
let drawing = false;

/* ZEICHNEN */
canvas.addEventListener("pointerdown", e => {
  drawing = true;
  ctx.beginPath();
  ctx.moveTo(e.offsetX,e.offsetY);
});
canvas.addEventListener("pointermove", e => {
  if(!drawing) return;
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.stroke();
});
canvas.addEventListener("pointerup", () => drawing=false);

/* START */
startRound();

function startRound() {
  field.innerHTML="";
  ctx.clearRect(0,0,canvas.width,canvas.height);
  currentWord="";

  spawnBall(false); // echter Ball
  for(let i=0;i<6;i++) spawnBall(true); // Fake-Bälle
}

function spawnBall(fake){
  const b=document.createElement("div");
  b.className="ball "+(fake?"fake":"real");

  b.style.left=Math.random()*(innerWidth-20)+"px";
  b.style.top=Math.random()*(innerHeight-20)+"px";

  if(fake) b.style.background=fakeColors[Math.floor(Math.random()*fakeColors.length)];

  field.appendChild(b);
  setTimeout(()=>b.style.opacity=1,100);
  setTimeout(()=>b.style.opacity=0,800);

  if(!fake) b.onclick=showWord;
}

function showWord(){
  currentWord=words[Math.floor(Math.random()*words.length)];
  wordFlash.textContent=currentWord;
  setTimeout(()=>wordFlash.textContent="✍️ Schreib das Wort hier!",1000);
}

/* FERTIG → nur korrekt */
doneBtn.onclick=()=>{
  // Canvas in Text umwandeln (vereinfachte Erkennung)
  // Wir vergleichen Anzahl der Striche mit einer Minimalanforderung
  const data=ctx.getImageData(0,0,canvas.width,canvas.height);
  let count=0;
  for(let i=0;i<data.data.length;i+=4){
    if(data.data[i+3]>128) count++;
  }

  // Minimaler Check: >50 Pixel = korrekt
  if(count>50){
    // Hier könntest du echte Erkennung einfügen
    alert("Richtig! Nächste Runde.");
    startRound();
  }else{
    alert("Noch nicht korrekt! Schreib das Wort richtig.");
  }
};
</script>

</body>
</html>
